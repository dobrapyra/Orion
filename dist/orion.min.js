Element.prototype.getOffset=function(t,e){var i,s={l:0,t:0};for(i=this;i&&i!==t;i=i.offsetParent)s.l+=i.offsetLeft,s.t+=i.offsetTop,e&&(s.l-=i.scrollLeft,s.t-=i.scrollTop);return s};
/*! url: https://github.com/dobrapyra/GameLoop */
var Loop=function(t){this.init(t)};Object.assign(Loop.prototype,{init:function(t){var e=function(){};this.onUpdate=t.handleUpdate||e,this.onRender=t.handleRender||e,this.onPanic=t.handlePanic||e,this.onRawFrame=t.handleRawFrame||null,this.timestep=t.timestep||1e3/60,this.minFrameTime=1e3/(t.fpsLimit||66),this.fpsMeter=t.fpsMeter||!0,this.started=!1,this.running=!1,this.rafId=null,this.lastFrameTime=0,this.lastFpsUpdate=0,this.framesThisSecond=0,this.delta=0,this.fps=this.fpsMeter?0:null,this.start=this.start.bind(this),this.stop=this.stop.bind(this),this.initLoop=this.initLoop.bind(this),this.loop=this.loop.bind(this)},update:function(t){this.onUpdate(t)},render:function(t){this.onRender(t,this.fps)},start:function(){this.started||(this.started=!0,this.rafId=requestAnimationFrame(this.initLoop))},stop:function(){this.running=!1,this.started=!1,cancelAnimationFrame(this.rafId)},initLoop:function(t){this.render(1),this.running=!0,this.lastFrameTime=t,this.lastFpsUpdate=t,this.framesThisSecond=0,this.rafId=requestAnimationFrame(this.loop)},loop:function(t){if(null!==this.onRawFrame)return this.onRawFrame(t),void(this.rafId=requestAnimationFrame(this.loop));if(t<this.lastFrameTime+this.minFrameTime)this.rafId=requestAnimationFrame(this.loop);else{this.delta+=t-this.lastFrameTime,this.lastFrameTime=t,this.fpsMeter&&(t>this.lastFpsUpdate+1e3&&(this.fps=this.framesThisSecond,this.lastFpsUpdate=t,this.framesThisSecond=0),this.framesThisSecond++);for(var e=0;this.delta>=this.timestep;)if(this.update(this.timestep),this.delta-=this.timestep,240<=++e){this.panic();break}this.render(this.delta/this.timestep),this.rafId=requestAnimationFrame(this.loop)}},panic:function(){this.delta=0,this.onPanic()}});var OrionConstellation=function(t){this.init(t)};Object.assign(OrionConstellation.prototype,{init:function(t){var e=t.points||{},i=t.force||{},s=t.amplitude||{},r=t.speed||{};this.borderVertices=Object.assign([],e.border),this.prepareVertices(this.borderVertices,{force:i.border||60},{static:!0,border:!0}),this.insideVertices=Object.assign([],e.inside),this.prepareVertices(this.insideVertices,{ampMin:s.min,ampMax:s.max,speedMin:r.min,speedMax:r.max,force:i.border||40}),this.cursorPoint={curr:{x:0,y:0},force:i.cursor||120},this.vertices=[].concat(this.borderVertices,this.insideVertices),this.vertices.push(this.cursorPoint),this.createEdges(),this.cursorPoint.static=!0},prepareVertices:function(t,e,i){for(var s=!(!i||!i.static),r=void 0!==e.ampMin?e.ampMin:10,n=e.ampMax?e.ampMax-r:0,a=e.speedMin||.001,o=e.speedMax?e.speedMax-a:0,h=e.force||50,c=0,d=t.length;c<d;c++){var p=t[c];p.last={x:p.x,y:p.y},p.curr={x:p.x,y:p.y},s||(p.amp={x:Math.random()*n+r,y:Math.random()*n+r},p.angle={x:2*Math.random()*Math.PI,y:2*Math.random()*Math.PI},p.speed={x:Math.random()*o+a,y:Math.random()*o+a}),p.force=h,Object.assign(p,i)}},createEdges:function(){this.edges=[];var t,e,i=this.vertices.length;for(t=0;t<i;t++){var s=this.vertices[t];for(e=t+1;e<i;e++){var r=this.vertices[e];if(!s.border||!r.border){var n=s.static&&r.static,a=s.force+r.force;this.edges.push({v1:s,v2:r,lastA:0,currA:n?1-Math.min(Math.sqrt(Math.pow(r.curr.x-s.curr.x,2)+Math.pow(r.curr.y-s.curr.y,2))/a,1):0,force:a,static:n})}}}},setCursor:function(t,e){this.cursorPoint.curr={x:t,y:e}},update:function(t){for(var e=0,i=this.vertices.length;e<i;e++){var s=this.vertices[e];s.static||(s.last={x:s.curr.x,y:s.curr.y},s.angle.x+=t*s.speed.x,s.angle.y+=t*s.speed.y,s.curr={x:s.x+s.amp.x*Math.sin(s.angle.x),y:s.y+s.amp.y*Math.cos(s.angle.y)})}for(e=0,i=this.edges.length;e<i;e++){var r=this.edges[e];if(!r.static){var n=r.v1,a=r.v2;r.lastA=r.currA,r.currA=1-Math.min(Math.sqrt(Math.pow(a.curr.x-n.curr.x,2)+Math.pow(a.curr.y-n.curr.y,2))/r.force,1)}}},render:function(t,e){e.lineCap="round",e.lineWidth=1,e.strokeStyle="rgba(255,255,255,0.5)";var i=this.borderVertices[0];e.beginPath(),e.moveTo(i.x,i.y);for(var s=0,r=this.borderVertices.length;s<r;s++){var n=this.borderVertices[s];e.lineTo(n.x,n.y)}e.closePath(),e.stroke();for(s=0,r=this.edges.length;s<r;s++){var a=this.edges[s];if(!(a.currA<=0)){var o,h,c,d,p=a.v1,l=a.v2;if(!p.hidden&&!l.hidden)a.static?e.strokeStyle="rgba(255,255,255,"+a.currA+")":e.strokeStyle="rgba(255,255,255,"+(a.lastA+(a.currA-a.lastA)*t)+")",p.static?(o=p.curr.x,h=p.curr.y):(o=p.last.x+(p.curr.x-p.last.x)*t,h=p.last.y+(p.curr.y-p.last.y)*t),l.static?(c=l.curr.x,d=l.curr.y):(c=l.last.x+(l.curr.x-l.last.x)*t,d=l.last.y+(l.curr.y-l.last.y)*t),e.beginPath(),e.moveTo(o,h),e.lineTo(c,d),e.stroke()}}e.strokeStyle="rgb(255,255,255)",e.lineWidth=3;for(s=0,r=this.vertices.length;s<r;s++){var f,u;(n=this.vertices[s]).static?(f=n.curr.x,u=n.curr.y):(f=n.last.x+(n.curr.x-n.last.x)*t,u=n.last.y+(n.curr.y-n.last.y)*t),e.beginPath(),e.moveTo(f,u),e.lineTo(f+.2,u+.2),e.stroke()}}});var Orion=function(t){this.init(t)};Object.assign(Orion.prototype,{init:function(t){this.viewport=t.viewport,this.canvas=this.createCanvas(),this.ctx=this.canvas.getContext("2d"),this.fpsMeter=t.fpsMeter,this.w=t.w||1280,this.h=t.h||720,this.canvas.width=this.w,this.canvas.height=this.h,this.refreshContext(),this.loop=new Loop({fpsLimit:t.fpsLimit||36,handleUpdate:this.update.bind(this),handleRender:this.render.bind(this),fpsMeter:!!this.fpsMeter}),this.constellation=new OrionConstellation(t.constellation),this.bindEvents(),this.loop.start()},createCanvas:function(){var t=document.createElement("canvas");return Object.assign(t.style,{position:"relative",width:"100%",height:"auto"}),this.viewport.appendChild(t),t},refreshContext:function(){this.scale=Math.round(this.canvas.offsetWidth/this.canvas.width*1e5)/1e5,this.viewportOffset=this.viewport.getOffset()},bindEvents:function(){this.viewport.addEventListener("mousemove",this.onMouseMove.bind(this)),window.addEventListener("resize",this.onWinResize.bind(this))},onMouseMove:function(t){var e=(t.pageX-this.viewportOffset.l)/this.scale,i=(t.pageY-this.viewportOffset.t)/this.scale;this.constellation.setCursor(e,i)},onWinResize:function(t){clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(this.onResizeTimeout.bind(this),200)},onResizeTimeout:function(){this.refreshContext()},update:function(t){this.constellation.update(t)},render:function(t,e){this.ctx.clearRect(0,0,this.w,this.h),this.constellation.render(t,this.ctx),this.fpsMeter&&(this.fpsMeter.innerText=Math.round(e)+" FPS")}});